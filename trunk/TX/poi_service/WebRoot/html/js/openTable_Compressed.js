function TNDatePicker(a){this.setConfig(a);this.flushCal()}
TNDatePicker.prototype={type:"double",container:null,checkInDateTarget:null,checkOutDateTarget:null,todayDate:null,checkInDate:new Date,checkOutDate:null,mArr:null,wArr:null,month:null,year:null,hasPreMonth:false,hasNextMonth:true,currentOperation:null,setConfig:function(a){if(!a||!a.type)alert("Please indicate the type of calendar, it should be 'single' or 'double'");this.type=a.type;if(!a||!a.container)alert("Please indicate the id of the container for the calendar");if(!a||!a.checkInDateTarget)alert("Please indicate the id of the check In Date Container");
if(a.type=="double"&&(!a||!a.checkOutDateTarget))alert("Please indicate the id of the check Out Date Container");this.container=a.container;this.checkInDateTarget=a.checkInDateTarget;this.checkOutDateTarget=a.checkOutDateTarget;this.todayDate=new Date;this.mArr=a.mArr?a.mArr:["January","February","March","April","May","June","July","August","September","October","November","December"];this.wArr=a.wArr?a.wArr:["Sun","Mon","Tue","Wed","Tur","Fri","Sat"];this.month=a.month?a.month:this.todayDate.getMonth()+
1;this.year=a.year?a.year:this.todayDate.getFullYear();this.checkInDate.setHours(1,1,1,1);$("#"+this.checkInDateTarget).html(this.dateToStr(this.checkInDate))},isDouble:function(){return this.type=="double"},flushCal:function(){$("#"+this.container).html(this.buildCal(this.mArr,this.wArr,this.month,this.year))},calChangeCSS:function(a,b){a.className=b},nextMonth:function(){if(this.month<12)this.month+=1;else{this.month=1;this.year+=1}this.hasNextMonth=this.hasPreMonth=true;this.flushCal()},strToDate:function(a){a=
a.split("-");var b=new Date;b.setFullYear(a[0],a[1]-1,a[2]);b.setHours(1,1,1,1);return b},dateToStr:function(a){var b="";if(this.dayDiff(a,this.todayDate)==0)b="";b+=this.addZero(a.getMonth()+1)+"/"+this.addZero(a.getDate())+"/"+(a.getFullYear()+"").substring(2,4);return b},addZero:function(a){return a<10?"0"+a:a},getTomorrow:function(){var a=new Date;a.setDate(a.getTime()+864E5);return a},getDaySpan:function(a,b){var c=b.getTime()-a.getTime();console.log("DiffMs:"+c/864E5);return Math.floor(c/864E5)},
preMonth:function(){if(this.hasPreMonth){if(this.year==this.todayDate.getFullYear()&&this.month<=this.todayDate.getMonth()+1)this.hasPreMonth=false;else{if(this.month==1){this.month=12;this.year-=1}else this.month-=1;this.hasPreMonth=true}this.hasNextMonth=true;this.flushCal()}},highlightPreIcon:function(){$("#preImg").attr("class","hotel_previous_arrow_icon_focused")},dishighlightPreIcon:function(){$("#preImg").attr("class","hotel_previous_arrow_icon_unfocused")},highlightNextIcon:function(){$("#nextImg").attr("class",
"hotel_next_arrow_icon_focused")},dishighlightNextIcon:function(){$("#nextImg").attr("class","hotel_next_arrow_icon_unfocused")},showForCheckIn:function(){if(this.checkInDate){console.log("Change  check in Month"+this.month);if(this.month!=this.checkInDate.getMonth()+1){this.month=this.checkInDate.getMonth()+1;this.hasPreMonth=this.month==this.todayDate.getMonth()+1?false:true;this.flushCal()}}$("#"+this.container).show();this.currentOperation=1},showForCheckOut:function(){if(this.checkOutDate)if(this.month!=
this.checkOutDate.getMonth()+1){console.log("Change Month:"+this.month);this.month=this.checkOutDate.getMonth()+1;this.hasPreMonth=this.month==this.todayDate.getMonth()+1?false:true;this.flushCal()}$("#"+this.container).show();this.currentOperation=0},setCheckOutDate:function(a){(this.checkOutDate=a)?$("#"+this.checkOutDateTarget).html(this.dateToStr(this.checkOutDate)):$("#"+this.checkOutDateTarget).html("&nbsp;");this.flushCal()},getCheckInDate:function(){return this.checkInDate},getCheckOutDate:function(){return this.checkOutDate},
jumpToDate:function(a,b){if(a){var c=new Date;c.setTime(a.getTime()+b*864E5);console.log(c.toLocaleString());return c}},syncNightsQuantity:function(){if(this.checkInDate&&this.checkOutDate){Global_nightQuantity=this.getDaySpan(this.checkInDate,this.checkOutDate);console.log("Sync:"+Global_nightQuantity);$("#nightQuantity").html(Global_nightQuantity);$("#nightSubImg").attr("src",GLOBAL_sharedImageUrl+"subtract_icon_unfocused.png")}},onSelectDate:function(a,b){var c=this.strToDate(b);console.log(b);
console.log(c.toDateString());this.currentOperation==null&&alert("Unknown operation");if(this.currentOperation==1){if(this.dayDiff(c,this.todayDate)<0){alert("Invalid Date, You can't choose the day past.");return}if(this.isDouble())if(this.checkOutDate&&this.dayDiff(c,this.checkOutDate)>=0){alert("Invalid Date, Check In Date Should Be Earlier Than Check Out Date");return}this.checkInDate&&$(".clsSelectedCheckInBg").attr("class","clsDayTd gray");a.className="clsDayTd clsSelectedCheckInBg white";this.checkInDate=
c;$("#"+this.checkInDateTarget).html(this.dateToStr(this.checkInDate));CommonUtil.debug("set the check in date:"+this.checkInDate.toLocaleString())}else{if(this.dayDiff(c,this.todayDate)<0){alert("Invalid Date, You can't choose the day past.");return}if(this.checkInDate&&this.dayDiff(c,this.checkInDate)<=0){alert("Invalid Date, Check Out Date Should Be Later Than Check Out Date");return}this.checkOutDate&&$(".clsSelectedCheckOutBg").attr("class","clsDayTd gray");a.className="clsDayTd clsSelectedCheckOutBg white";
this.checkOutDate=c;$("#"+this.checkOutDateTarget).html(this.dateToStr(this.checkOutDate));CommonUtil.debug("set the check out date:"+this.checkOutDate)}this.syncNightsQuantity()},dayDiff:function(a,b){var c=a.getFullYear()*372+a.getMonth()*31+a.getDate(),d=b.getFullYear()*372+b.getMonth()*31+b.getDate();return c-d},selectDone:function(){$("#"+this.container).hide()},buildCal:function(a,b,c,d){var e=[31,0,31,30,31,30,31,31,30,31,30,31],f=new Date(d,c-1,1);f.od=f.getDay()+1;var g=new Date;g=d==g.getFullYear()&&
c==g.getMonth()+1?g.getDate():0;e[1]=f.getFullYear()%100!=0&&f.getFullYear()%4==0||f.getFullYear()%400==0?29:28;a='<table class="bg_title clsCalendarToolBar"><tr width="100%" height="100%"><td width="10%" ontouchstart="Global_calendar.highlightPreIcon()" ontouchend="Global_calendar.dishighlightPreIcon()" onClick="Global_calendar.preMonth();"><img id="preImg" class="hotel_previous_arrow_icon_unfocused"/></td><td class="white" width="80%" height="100%">'+a[c-1]+" - "+d+'</td><td onclick="Global_calendar.nextMonth();" onTouchStart="Global_calendar.highlightNextIcon()" onTouchEnd="Global_calendar.dishighlightNextIcon()"><img id="nextImg" class="hotel_next_arrow_icon_unfocused" /></td></tr></table><div class="clsCalendarMainBody clsPanelBg"><div class="clsShadowBar"></div>';
a+='<table class="clsCanlendarPanel clsAllRadius" cols="7" cellpadding="0" cellspacing="0">';a+='<tr class="clsWeekDayRow">';for(s=0;s<7;s++)a+='<td class="clsWeekDayTd">'+b[s]+"</td>";a+='</tr><tr align="center" class="clsDayRow">';for(i=1;i<=42;i++){b=i-f.od>=0&&i-f.od<e[c-1]?i-f.od+1:"&nbsp;";var h=false;if(b=="&nbsp;")h=false;else{var j=new Date;j.setFullYear(d,c-1,b);if(this.dayDiff(j,this.todayDate)>=0)h=true}var k;k=b==g?'<span id="today">'+b+"</span>":b;var l="";l=h&&this.checkInDate&&this.dayDiff(j,
this.checkInDate)==0?"clsDayTd clsSelectedCheckInBg white":h&&this.checkOutDate&&this.dayDiff(j,this.checkOutDate)==0?"clsDayTd clsSelectedCheckOutBg white":"clsDayTd gray";var m=null;m=h?" onClick=\"Global_calendar.onSelectDate(this,'"+this.year+"-"+this.month+"-"+b+"')\"":"";a+='<td class="'+l+'"'+m+">"+k+"</td>";if(i%7==0&&i<36)a+='</tr><tr align="center" class="clsDayRow">'}a+="</tr></table>";a+='<table class="clsConfirmBar"><tr class="clsFullFilled"><td class="clsFullFilled" align="center"><div class="clsButtonContainer"  onclick="Global_calendar.selectDone();"><table class="clsDoneBtnSkeleton clsBtnRadius fc_gray veryLarge clsDontBtnBgNormal"  onTouchStart=\'Global_calendar.calChangeCSS(this,"clsDoneBtnSkeleton clsBtnRadius white veryLarge clsDontBtnBgHL")\'  onTouchEnd=\'Global_calendar.calChangeCSS(this,"clsDoneBtnSkeleton clsBtnRadius gray veryLarge clsDontBtnBgNormal")\'><tr><td class="veryLarge">Done</td></tr></table></div></td></tr></table></div></div>';
return a}};var Global_calendar=null;function TimePicker(a){this.init(a)}
TimePicker.prototype={time:new Date,hour:0,minute:0,zone:"AM",timeDisplay:"06:30PM",containerDiv:"timePickerDiv",timeContainerOutSide:"openTableCheckInTime",backGroundDiv:"slowBackgroundPopup",intervalId:null,INTERVAL:300,buildWidget:function(){document.getElementById("timePickerDiv").innerHTML='<div class="popGreyWindowBg" width="100%">\t<table class="timePickerMainBoard " cellpadding="0" cellspacing="0" border="0">\t\t<tr>\t\t\t<td colspan="3" align="center" class="pickerTitle">\t\t\t\t\t\t\t\tSet Time\t\t\t</td>\t\t</tr>\t\t<tr>\t\t\t<td>\t\t\t\t<table align="center"  cellpadding="0" cellspacing="5" border="0" width="90%">\t\t\t\t\t<tr>\t\t\t\t\t\t<td align="center" width="33%">\t\t\t\t\t\t\t<div class="clsPickerBtnContainer">\t\t\t\t\t\t\t\t<table width="100%" height="100%">\t\t\t\t\t\t\t\t\t<tr width="100%" height="100%">\t\t\t\t\t\t\t\t\t\t<td id="hourPlus" class="pickerBtnSkeleton clsPickerBtnBgNormal pickerBtnRadiusTop fc_gray" \t\t\t\t\t\t\t\t\t\tonTouchStart="Global_timePicker.continousHourPlus();Global_timePicker.highlight(this)"                                             onclick="Global_timePicker.hourPlus()" onTouchEnd="Global_timePicker.stopContiusOperation(this);Global_timePicker.dishighlight(this)">+</td>\t\t\t\t\t\t\t\t\t</tr>\t\t\t\t\t\t\t\t\t\t</table>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t<table  class="valueArea">\t\t\t\t\t\t\t\t<tr width="100%" height="100%">\t\t\t\t\t\t\t\t\t<td valign="middle" align="center">\t\t\t\t\t\t\t\t\t\t<span id="hourValueDisplay"></span>\t\t\t\t\t\t\t\t\t</td>\t\t\t\t\t\t\t\t</tr>\t\t\t\t\t\t\t</table>\t\t\t\t\t\t\t<div class="clsPickerBtnContainer">\t\t\t\t\t\t\t\t<table width="100%" height="100%">\t\t\t\t\t\t\t\t\t<tr width="100%" height="100%">\t\t\t\t\t\t\t\t\t\t<td id="hourMinus" class="pickerBtnSkeleton clsPickerBtnBgNormal pickerBtnRadiusBottom fc_gray" onTouchStart="Global_timePicker.continousHourMinus(this);Global_timePicker.highlight(this)" onclick="Global_timePicker.hourMinus()" onTouchEnd="Global_timePicker.stopContiusOperation(this);Global_timePicker.dishighlight(this)">-</td>\t\t\t\t\t\t\t\t\t</tr>\t\t\t\t\t\t\t\t</table>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t</td>\t\t\t\t\t\t<td align="center" width="33%">\t\t\t\t\t\t\t<div class="clsPickerBtnContainer">\t\t\t\t\t\t\t\t<table width="100%" height="100%">\t\t\t\t\t\t\t\t\t<tr width="100%" height="100%">\t\t\t\t\t\t\t\t\t\t<td id="minPlus" class="pickerBtnSkeleton clsPickerBtnBgNormal pickerBtnRadiusTop fc_gray" onTouchStart="Global_timePicker.continousMinutePlus(this);Global_timePicker.highlight(this)" onclick="Global_timePicker.minPlus()" onTouchEnd="Global_timePicker.stopContiusOperation(this);Global_timePicker.dishighlight(this)">+</td>\t\t\t\t\t\t\t\t\t</tr>\t\t\t\t\t\t\t\t\t\t</table>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t<table  class="valueArea">\t\t\t\t\t\t\t\t<tr width="100%" height="100%">\t\t\t\t\t\t\t\t\t<td valign="middle" align="center">\t\t\t\t\t\t\t\t\t\t<span id="minuteValueDisplay"></span>\t\t\t\t\t\t\t\t\t</td>\t\t\t\t\t\t\t\t</tr>\t\t\t\t\t\t\t</table>\t\t\t\t\t\t\t<div class="clsPickerBtnContainer">\t\t\t\t\t\t\t\t<table width="100%" height="100%">\t\t\t\t\t\t\t\t\t<tr width="100%" height="100%">\t\t\t\t\t\t\t\t\t\t<td id="minMinus" class="pickerBtnSkeleton clsPickerBtnBgNormal pickerBtnRadiusBottom fc_gray" onTouchStart="Global_timePicker.continousMinuteMinus(this);Global_timePicker.highlight(this)" onclick="Global_timePicker.minMinus()" onTouchEnd="Global_timePicker.stopContiusOperation(this);Global_timePicker.dishighlight(this)">-</td>\t\t\t\t\t\t\t\t\t</tr>\t\t\t\t\t\t\t\t</table>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t</td>\t\t\t\t\t\t<td align="center" width="33%">\t\t\t\t\t\t\t<div class="clsPickerBtnContainer">\t\t\t\t\t\t\t\t<table width="100%" height="100%">\t\t\t\t\t\t\t\t\t<tr width="100%" height="100%">\t\t\t\t\t\t\t\t\t\t<td id="zoneValue" class="pickerBtnSkeleton clsPickerBtnBgNormal pickerBtnRadius fc_gray" onClick="Global_timePicker.changeZone()" onTouchStart="Global_timePicker.highlight(this)" onTouchEnd="Global_timePicker.dishighlight(this)">PM</td>\t\t\t\t\t\t\t\t\t</tr>\t\t\t\t\t\t\t\t</table>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t</td>\t\t\t\t</tr>\t\t\t</table>\t\t</td>\t</tr></table></div><table class="popGreyWindowBottomRowBg pickerBottomBar" >\t<tr >\t\t<td width="100%" align="center">\t\t\t<table width="90%" height="80%">\t\t\t\t<tr>\t\t\t\t\t<td width="50%">\t\t\t\t\t\t\t\t<input type="button" id="set" class="pickerBtnSkeleton clsPickerBtnBgNormal pickerBtnRadius fc_gray" onclick="Global_timePicker.done()" value="Set" onTouchStart="Global_timePicker.highlight(this)" onTouchEnd="Global_timePicker.dishighlight(this)">\t\t\t\t\t</td>\t\t\t\t\t<td width="50%">\t\t\t\t\t\t\t\t<input type="button" id="close" class="pickerBtnSkeleton clsPickerBtnBgNormal pickerBtnRadius fc_gray" onClick="Global_timePicker.cancel()" value="Cancel" onTouchStart="Global_timePicker.highlight(this)" onTouchEnd="Global_timePicker.dishighlight(this)" />\t\t\t\t\t</td>\t\t\t\t</tr>\t\t\t</table>\t\t</td>\t</tr>\t</table>'},init:function(a){if(a){this.containerDiv=
a.containerDiv;this.timeContainerOutSide=a.timeContainerOutSide;this.backGroundDiv=a.backGroundDiv}this.buildWidget();this.time=new Date;this.hour=this.time.getHours();this.minute=this.time.getMinutes();this.hour>12?this.zone="PM":this.zone="AM";this.flush()},flush:function(){this.hour=this.time.getHours();this.minute=this.time.getMinutes();this.hour>11?this.zone="PM":this.zone="AM";$("#hourValueDisplay").html(this.hour>12?this.addZero(this.hour-12):this.addZero(this.hour));$("#minuteValueDisplay").html(this.addZero(this.minute));
$("#zoneValue").html(this.zone);$("#"+this.timeContainerOutSide).html((this.hour>12?this.addZero(this.hour-12):this.addZero(this.hour))+":"+this.addZero(this.minute)+"  "+this.zone)},addZero:function(a){return a<10?"0"+a:a},hourPlus:function(){console.log("hourPlus");this.time.setTime(this.time.getTime()+36E5);this.flush()},hourMinus:function(){console.log("hourMinus");this.time.setTime(this.time.getTime()-36E5);this.flush()},minPlus:function(){console.log("minPlus");this.time.setTime(this.time.getTime()+
6E4);this.flush()},minMinus:function(){console.log("minPlus");this.time.setTime(this.time.getTime()-6E4);this.flush()},continousHourPlus:function(){this.stopContiusOperation();console.log("continousHourPlus");var a=this;this.intervalId=window.setInterval(function(){a.hourPlus()},this.INTERVAL)},continousMinutePlus:function(){this.stopContiusOperation();console.log("continousMinutePlus");var a=this;this.intervalId=window.setInterval(function(){a.minPlus()},this.INTERVAL)},continousHourMinus:function(){this.stopContiusOperation();
console.log("continousHourMinus");var a=this;this.intervalId=window.setInterval(function(){a.hourMinus()},this.INTERVAL)},continousMinuteMinus:function(){this.stopContiusOperation();console.log("continousMinuteMinus");var a=this;this.intervalId=window.setInterval(function(){a.minMinus()},this.INTERVAL)},stopContiusOperation:function(){console.log("stopContiusOperation");clearInterval(this.intervalId);this.intervalId=null},getTime:function(){return this.getHourWithZero()+":"+this.getMinuteWithZero()},
getHour:function(){return this.hour},getMinute:function(){return this.minute},getHourWithZero:function(){return this.addZero(this.hour)},getMinuteWithZero:function(){return this.addZero(this.minute)},changeZone:function(){this.time.setTime(this.time.getTime()+432E5);this.flush()},cancel:function(){$("#"+this.containerDiv).hide();$("#"+this.backGroundDiv).hide()},show:function(){$("#"+this.containerDiv).attr("class","timepickerBody");$("#"+this.backGroundDiv).attr("class","slowBackgroundPopup");$("#"+
this.containerDiv).show();$("#"+this.backGroundDiv).show()},done:function(){$("#"+this.containerDiv).hide();$("#"+this.backGroundDiv).hide()},highlight:function(a){var b=a.className;b=b.replace(/clsPickerBtnBgNormal/g,"clsPickerBtnBgHL");b=b.replace(/fc_gray/g,"fc_white");a.className=b},dishighlight:function(a){var b=a.className;b=b.replace(/clsPickerBtnBgHL/g,"clsPickerBtnBgNormal");b=b.replace(/fc_white/g,"fc_gray");a.className=b}};var Global_timePicker=null;function sizePicker(){this.initSize=20;this.pickedSize=1;this.title="Please enter a party size:";this.unit="person";this.units="people";this.titleImgSrc="";this.titleClass="sizePickerRow  bold fc_gray fs_veryLarge";this.cancelBarClass="sizePickerCancelBar clsTitleBg";this.cancel="Cancel";this.set="Set";this.container="partySizeWidget";this.target="openTablePartySize"}
sizePicker.prototype={flush:function(){$("#"+this.target).html(this.pickedSize+" &nbsp;"+(this.pickedSize>1?this.units:this.unit))},setSize:function(a){this.pickedSize=a},getSize:function(){return this.pickedSize},init:function(){var a='<div class="popGreyWindowBg" width="100%"><table id="sizePickerTitleBar" class="'+this.titleClass+'">\t<tr>\t\t<td class="sizePickerRow">'+this.title+"\t\t</td>\t</tr></table>";a+='<table class="sizePickerRow">\t<tr>\t\t<td class="sizePickerRow"><input type="number" min="1" max="20" value="1" class="fc_gray sizePickerInput fs_veryLarge" id="sizePickerInput"/></td>\t</tr></table><table>\t<tr>\t\t<td align="center" class="sizePickerRow bold fc_gray fs_middle">Note:Maximum Party Size is 20 people</td>\t</tr></table></div>';
a+='<table id="sizePickerCancelBar" class="sizePickerRow popGreyWindowBottomRowBg"> <tr>\t<td  width="50%" height="100%" align="center" valign="middle">\t\t<input type="button"  value="'+this.set+'" onclick="Global_partySizePicker.done()" ontouchend="changeCSS(this,\'sizePickerBtnSize fc_gray fs_veryLarge clsLargeRadius clsButtonBgNormal\')" ontouchStart="changeCSS(this,\'sizePickerBtnSize fc_white fs_veryLarge clsLargeRadius clsButtonBgHighlight\')" class="sizePickerBtnSize fc_gray fs_veryLarge clsLargeRadius clsButtonBgNormal">\t</td>\t<td  width="50%" height="100%" align="center" valign="middle">\t\t<input type="button"  value="'+
this.cancel+'" onclick="Global_partySizePicker.cancle()" ontouchend="changeCSS(this,\'sizePickerBtnSize fc_gray fs_veryLarge clsLargeRadius clsButtonBgNormal\')" ontouchStart="changeCSS(this,\'sizePickerBtnSize fc_white fs_veryLarge clsLargeRadius clsButtonBgHighlight\')" class="sizePickerBtnSize fc_gray fs_veryLarge clsLargeRadius  clsButtonBgNormal">\t</td> </tr></table>';$("#"+this.container).html(a)},show:function(){$("#"+this.container).show();$("#slowBackgroundPopup").show()},done:function(){this.setSize($("#sizePickerInput").val());
this.flush();$("#"+this.container).hide();$("#slowBackgroundPopup").hide()},cancle:function(){$("#"+this.container).hide();$("#slowBackgroundPopup").hide()}};var Global_partySizePicker=null;function OpenTableJS(){}
OpenTableJS.prototype={checkData:function(){},getPartnerPoiId:function(){return 32},fetchTimePeriod:function(){var a=Global_calendar.getCheckInDate();a=a.getFullYear()+"-"+(a.getMonth()+1)+"-"+a.getDate();var b=Global_timePicker.getHourWithZero()+":"+Global_timePicker.getMinuteWithZero();a={PartySize:Global_partySizePicker.getSize(),SearchRequestTime:b,SearchRequestDate:a,lafObjectId:this.getPartnerPoiId()};a=GLOBAL_hostUrl+"getTableAvailable.do?jsonStr="+JSON.stringify(a)+"&"+CommonUtil.getClientInfo();
CommonUtil.debug(a);loadPopup_poidetail();GLOBAL_xmlhttpforAjax.open("GET",a,true);GLOBAL_xmlhttpforAjax.onreadystatechange=function(){if(handleCommonAjaxError())if(GLOBAL_xmlhttpforAjax.responseText){var c=JSON.parse(GLOBAL_xmlhttpforAjax.responseText),d=c.SearchOfferTime1,e=c.SearchOfferTime2;c=c.SearchOfferTime3;if((!d||d=="")&&(!e||e=="")&&(!c||c==""))CommonUtil.showAlert("",I18NHelper["openTable.noTableAvailable"],I18NHelper["common.button.OK"]);else{$("#openTableTime1").html(d);$("#openTableTime2").html(e);
$("#openTableTime3").html(c);$("#restaurant_openTableTime1").val(d);$("#restaurant_openTableTime2").val(e);$("#restaurant_openTableTime3").val(c);if(!d||d=="")$("#openTableTime1").hide();if(!e||e=="")$("#openTableTime2").hide();if(!c||c=="")$("#openTableTime3").hide();$("#restaurant_availalbeTimeTable").show();$("#restaurant_findTablesBtn").hide();$("#restaurant_pickTimeTable").hide();$("#restaurant_partySizeTable").attr("class","clsConfigRow clsMiddleItemRadius fs_small clsFontColor_gray");$("#restaurant_date_td").hide();
$("#restaurant_partySize_td").hide()}}else CommonUtil.showAlert("",I18NHelper["openTable.noTableAvailable"],I18NHelper["common.button.OK"])};GLOBAL_xmlhttpforAjax.send(null)},showMap:function(){var a=JSON.parse(CommonUtil.getFromCache(appendPoiKey(PoiCacheKeys.POIDETAIL))),b=a.poi.stop.lat;a=a.poi.stop.lon;if(b!=0&&a!=0){b/=JSConstants.DEGREE_MULTIPLIER;a/=JSConstants.DEGREE_MULTIPLIER;b=b+","+a;a=$("#mapImageDivWrapper").outerWidth();var c=$("#mapImageDivWrapper").outerHeight();a={imageName:"",width:a,
height:c,center:b,markers:"color:blue|"+b};b="http://mapapicdn.telenav.com/maps/staticmap?";b+="width="+a.width+"&height="+a.height+"&zoom=1&center=";b+=a.center+"&markers="+encodeURI(a.markers)+"&apiKey="+encodeURI("AQAAAS+jF+1of/////////8AAAABAAAAAQEAAAAQZUmvC1JKzdtXA+1AkO2ZqwEAAAAOAwAAAGsAAACYAAAAAgA=");$("#restaurantMapImg")[0].onerror=function(){PopupUtil.hide()};$("#restaurantMapImg")[0].onload=function(){PopupUtil.hide();$("#restaurantMapDiv").show();$("#restaurantMapImageDivWrapper").show()};
CommonUtil.debug(b);a=$("#restaurantMapImg")[0].src;$("#restaurantMapImg")[0].src=b;if(a==b){$("#restaurantMapDiv").show();$("#restaurantMapImageDivWrapper").show()}else loadPopup_poidetail()}GLOBAL_isRestaurantDetailLoaded=true},showOpenTableMain:function(){if(!GLOBAL_isRestaurantDetailLoaded){$("#restaurantDetailDiv").hide();partnerId=this.getPartnerPoiId();loadPopup_poidetail();var a={data:0,url:GLOBAL_hostUrl+"getRestaurantDetail.do?partnerId="+partnerId+"&"+CommonUtil.getClientInfo(),onSuccess:this.ajaxCBOpenTableMain};
CommonUtil.ajax(a);GLOBAL_xmlhttpforAjax.onreadystatechange=function(){handleCommonAjaxError()};GLOBAL_xmlhttpforAjax.send(null)}},ajaxCBOpenTableMain:function(a){if(a){$("#restaurantDetailDiv").show();a=JSON.parse(a);CommonUtil.debug(a);$("#restaurant_desc").html(a.RestaurantDescription);$("#restaurant_foodType").html(a.SearchFoodType);$("#restaurant_parking").html(a.Parking);$("#restaurant_url").html(a.RestaurantUrl);$("#restaurant_url").attr("href","http://"+a.RestaurantUrl);$("#restaurant_location_desc").html(a.RestaurantLocationDesc);
$("#restaurant_payment").html(a.RestaurantPaymentType);var b=0;b=a.SearchPriceSign;$("#restaurant_priceRange1").attr("class",getPriceClass(b));$("#restaurant_priceRange2").attr("class",getPriceClass(b-1));$("#restaurant_priceRange3").attr("class",getPriceClass(b-2));$("#restaurant_priceRange4").attr("class",getPriceClass(b-3));$("#restaurant_hiddenOpenHour").hide();if(a.HoursOfOperation&&a.HoursOfOperation!=null){a=a.HoursOfOperation;CommonUtil.debug(a);CommonUtil.debug(a.replace(/<BR>/g,"").replace(/\n/g,
""));$("#restaurant_hiddenOpenHour").html(a.replace(/<BR><BR>/g,"<BR>"))}GLOBAL_isRestaurantDetailLoaded=true;that.fetchDeals();$("#restaurantMapDiv").show()}else that.showMap()},fetchDeals:function(){var a=JSON.parse(CommonUtil.getFromCache(appendPoiKey(PoiCacheKeys.POIDETAIL)));shouldCallAdsServer(a)&&this.fetchOrganicAdsForOpenTable()},fetchOrganicAdsForOpenTable:function(){var a={data:0,loadingStyle:1,url:GLOBAL_hostUrl+"getPoiDetailData.do?operateType=adsPoi&jsonStr="+JSON.stringify(getPoiSearchKey())+
"&"+CommonUtil.getClientInfo()},b=this;a.onSuccess=function(c){c=CommonUtil.getValidString(c);if(""!=c){c=JSON.parse(c);c.success&&b.displayOpenTableDeal(c.dealTab)}};CommonUtil.ajax(a)},displayOpenTableDeal:function(a){CommonUtil.showAlert("",a,I18NHelper["common.button.OK"])},showOrHide:function(){var a=$("#restaurant_hiddenOpenHour").css("display");CommonUtil.debug(a);a=="block"?$("#restaurant_hiddenOpenHour").hide():$("#restaurant_hiddenOpenHour").show()},goToReservationDetail:function(a){var b=
Global_calendar.getCheckInDate();b=b.getFullYear()+"-"+(b.getMonth()+1)+"-"+b.getDate();a=$("#restaurant_openTableTime"+a).val();var c=b+" "+a,d=JSON.parse(CommonUtil.getFromCache(appendPoiKey(PoiCacheKeys.POIDETAIL))).poi,e=d.bizPoi.poiId;b={name:d.bizPoi.brand,partySize:Global_partySizePicker.getSize(),dateTime:c,date:b,time:a,partnerPoiId:this.getPartnerPoiId(),poiId:e};this.saveInfo(JSON.stringify(b),CommonUtil.getFromCache(appendPoiKey(PoiCacheKeys.POIDETAIL)),document.getElementById("logImageDiv").getElementsByTagName("IMG")[0].src);
b=LocalAppsURLHelper.RESTAURANT+"&"+CommonUtil.getClientInfo();CommonUtil.debug(b);SDKAPI.launchLocalApp(b)},saveInfo:function(a,b,c){navigator.tnservice.deletePersistentData("FOR_LOCALAPPS_DATA",function(){},function(){});navigator.tnservice.setPersistentData("FOR_LOCALAPPS_DATA",'{"OPENTABLE":'+('{"RESERVATION_CONFIG":'+a+', "RESTAURANT_POI_DETAIL":'+b+',"RESTAURANT_LOGO":"'+c+'"}')+"}","",function(){},function(){})},writeHTML:function(){var a=document.getElementById("poiopentablemain"),b=document.getElementById("poiopentablereserve"),
c="";c="";c='<div width="100%" id="restaurantDetailDiv" display="none">\t<table class="bg_orange fs_verySmall ot_deals fc_white">\t\t<tr>\t\t\t<td width="80%" class="left_pad">2 Deals Available</td>\t\t\t<td width="20%" align="right"><img class="hotel_next_arrow_icon_unfocused.png"></td>\t\t</tr>\t</table>\t<div class="ot_allPadding">\t\t<table width="100%">\t\t\t<tr>\t\t\t\t<td width="60%" >\t\t\t\t\t<table class="fc_gray fs_middle">\t\t\t\t\t\t<tr onclick="OpenTable.showOrHide()">\t\t\t\t\t\t\t<td class="ot_middleHeightLine" valign="top">\t\t\t\t\t\t\t\t\t<span class="fc_green bold">'+
I18NHelper["openTable.open"]+'</span>\t\t\t\t\t\t\t\t\t<span class="fc_gray">'+I18NHelper["openTable.hoursAvailable"]+'</span>\t\t\t\t\t\t\t</td>\t\t\t\t\t\t</tr>\t\t\t\t\t</table>\t\t\t\t</td>\t\t\t\t<td width="40%" align="right" valign="top" class="fc_gray fs_verySmall">\t\t\t\t\t<div id="restaurant_location_desc"></div>\t\t\t\t\t<div id="restaurant_parking"></div>\t\t\t\t</td>\t\t\t</tr>\t\t</table>\t\t<table width="100%">\t\t\t<tr>\t\t\t\t<td id="restaurant_hiddenOpenHour"  class="fc_gray fs_verySmall">\t</td>\t\t\t</tr>\t\t\t<tr>\t\t\t\t<td>\t\t\t\t\t<table>\t\t\t\t\t\t<tr>\t\t\t\t\t\t\t<td id="restaurant_priceRange1" class="clsDollarGrey" align="center">$</td><td width="2px"></td>\t\t\t\t\t \t\t<td id="restaurant_priceRange2" class="clsDollarGrey" align="center">$</td><td width="2px"></td>\t\t\t\t\t\t\t<td id="restaurant_priceRange3" class="clsDollarGrey" align="center">$</td><td width="2px"></td>\t\t\t\t\t\t\t<td id="restaurant_priceRange4" class="clsDollarGrey" align="center">$</td><td width="2px"></td>\t\t\t\t\t\t</tr>\t\t\t\t\t</table>\t\t\t\t</td>\t\t\t</tr>\t\t</table>\t\t<\!-- detail info --\>\t\t<table width="100%" class="fc_gray fs_middle">\t\t\t<tr>\t\t\t\t<td class="fc_gray"> <span class="bold">'+
I18NHelper["openTable.cuisine"]+':</span> <span id="restaurant_foodType"></span></td>\t\t\t</tr>\t\t\t<tr>\t\t\t\t<td class="fc_gray"> <span class="bold">'+I18NHelper["openTable.webSite"]+':</span> <span><a id="restaurant_url" href="#" class="fc_blue" onclick=""></a></span></td>\t\t\t</tr>\t\t\t<tr>\t\t\t\t<td class="fs_verySmall" id="restaurant_desc"></td>\t\t\t</tr>\t\t</table>\t</div>  </div>   <div id="restaurantMapDiv" style="display:none;" width="100%" align="center">   \t\t<div id="restaurantMapImageDivWrapper" class="clsRestaurantMapImageDiv" style="display:none;">   \t\t \t<img id="restaurantMapImg" class="clsRestaurantMapImg" src=""></img>   \t\t</div>   \t\t<table class="clsRestaurantMapButtonTable">   \t\t  <tr>\t\t \t <td id="mainButtonsBar" class="clsMainBottom" >\t\t\t\t<table border="0" cellpadding="0" cellspacing="0" width="99%" align="center" class="clsFixTable">\t\t\t\t  <tr>\t\t\t\t    <td width="20%" height="100%" align="left" valign="middle"><div class="clsBigButtonStyle fs_veryLarge fc_black clsLargeRadius clsButtonBgNormal" align="center" onClick="showMapOfClient()"\t\t\t\t    \tontouchstart="highlightBtnAll(this,\'fc_black\',\'fc_white\')" ontouchend="disHighlightBtnAll(this,\'fc_white\',\'fc_black\')">\t\t\t\t    \t<p class="clsBigButtonLabel">'+
I18NHelper["poidetail.button.map"]+'</p></div></td>\t\t\t\t\t<td width="5%"></td>\t\t\t\t\t<td width="20%" align="left" valign="middle" ><div class="clsBigButtonStyle fs_veryLarge fc_black clsLargeRadius clsButtonBgNormal" align="center" onClick="shareAddress()"\t\t\t\t\t\tontouchstart="highlightBtnAll(this,\'fc_black\',\'fc_white\')" ontouchend="disHighlightBtnAll(this,\'fc_white\',\'fc_black\')">\t\t\t\t\t\t<p  class="clsBigButtonLabel">'+I18NHelper["poidetail.button.share"]+'</p></div></td>\t\t\t\t\t<td width="5%"></td>\t\t\t\t\t<td width="45%" align="left" valign="middle" ><div class="clsBigButtonStyle fs_veryLarge fc_black clsLargeRadius clsButtonBgNormal" align="center"  onClick="searchNearBy()"\t\t\t\t\t\tontouchstart="highlightBtnAll(this,\'fc_black\',\'fc_white\')" ontouchend="disHighlightBtnAll(this,\'fc_white\',\'fc_black\')">\t\t\t\t\t\t<p  class="clsBigButtonLabel" >'+
I18NHelper["poidetail.button.searchnearby"]+"</p></div></td>\t\t\t\t  </tr>\t  \t\t\t\t</table>\t \t \t</td>  \t\t</tr>  \t  </table> </div>";a.innerHTML=c;c='<div class="clsOTRserveConfigBoard">\t<table class="clsConfigRow clsTopItemRadius fs_small clsFontColor_gray">\t\t<tr width="100%" onclick="Global_calendar.showForCheckIn();">\t\t\t<td width="30%" align="left"><span style="padding-left: 15px" class="bold">'+I18NHelper["openTable.date"]+'</span></td>\t\t\t<td  align="right" class="fc_blue" style="padding-right: 15px"><span id="openTableCheckInDate" ></span></td>\t\t\t<td id="restaurant_date_td" align="right" class="clsOpenTableImgTd"  align="center"><img src="'+
GLOBAL_sharedImageUrl+'hotel_calendar_icon_unfocused.png"></td>\t\t</tr>\t</table>\t<table class="clsConfigRow clsMiddleItemRadius fs_small clsFontColor_gray" id="restaurant_pickTimeTable">\t\t<tr width="100%"  onClick="Global_timePicker.show();">\t\t\t<td width="30%" align="left"><span style="padding-left: 15px" class="bold">'+I18NHelper["openTable.time"]+'</span></td>\t\t\t<td  align="right" class="fc_blue" style="padding-right: 15px">'+I18NHelper["openTable.around"]+' &nbsp;<span id="openTableCheckInTime"></span></td>\t\t\t<td id="restaurant_time_td" class="clsOpenTableImgTd"  align="center"><img src="'+
GLOBAL_sharedImageUrl+'ac_main_recent_icon_unfocused.png"></td>\t\t</tr>\t</table>\t<table class="clsConfigRow clsBottomItemRadius fs_small clsFontColor_gray" id="restaurant_partySizeTable">\t\t<tr onclick="Global_partySizePicker.show()">\t\t\t<td width="40%" align="left"><span style="padding-left: 15px" class="bold">'+I18NHelper["openTable.partySize"]+'</span></td>\t\t\t<td  align="right" class="fc_blue" style="padding-right: 15px"><span id="openTablePartySize">'+I18NHelper["openTable.onePerson"]+
'</span></td>\t\t\t<td id="restaurant_partySize_td" class="clsOpenTableImgTd" align="center"><img src="'+GLOBAL_sharedImageUrl+'down_blue_arrow.png" ></td>\t\t</tr>\t</table>\t<table id="restaurant_availalbeTimeTable" class="clsConfigRow clsBottomItemRadius fs_small clsFontColor_gray " style="display: none;">\t\t<tr>\t\t\t<td width="33.3%" align="middle">\t\t\t\t<button style="width:90%" onTouchStart="changeCSS(this,\'clsBigButtonStyle fs_veryLarge fc_white clsLargeRadius clsButtonBgRedHover\')"\t\t\t\t \t ontouchend="changeCSS(this,\'clsBigButtonStyle fs_veryLarge fc_white clsLargeRadius clsButtonBgRed\')" \t\t\t\t \t onclick="OpenTable.goToReservationDetail(1)" \t\t\t\t \t class="clsBigButtonStyle fs_veryLarge fc_white clsLargeRadius clsButtonBgRed" id="openTableTime1">\t\t\t\t</button>\t\t\t</td> \t\t\t<td width="33.3%"  align="middle">\t\t\t\t<button style="width:90%" onTouchStart="changeCSS(this,\'clsBigButtonStyle fs_veryLarge fc_white clsLargeRadius clsButtonBgRedHover\')"\t\t\t\t\t ontouchend="changeCSS(this,\'clsBigButtonStyle fs_veryLarge fc_white clsLargeRadius clsButtonBgRed\')" \t\t\t\t\t onclick="OpenTable.goToReservationDetail(2)" \t\t\t\t\t class="clsBigButtonStyle fs_veryLarge fc_white clsLargeRadius clsButtonBgRed"\t\t\t\t\t id="openTableTime2"></button>\t\t\t</td>\t\t\t<td width="33.3%" align="middle">\t\t\t\t<button style="width:90%" onTouchStart="changeCSS(this,\'clsBigButtonStyle fs_veryLarge fc_white clsLargeRadius clsButtonBgRedHover\')"\t\t\t\t\tontouchend="changeCSS(this,\'clsBigButtonStyle fs_veryLarge fc_white clsLargeRadius clsButtonBgRed\')" \t\t\t\t\tonclick="OpenTable.goToReservationDetail(3)" \t\t\t\t\tclass="clsBigButtonStyle fs_veryLarge fc_white clsLargeRadius clsButtonBgRed" id="openTableTime3"></button>\t\t\t</td>\t\t</tr>\t</table>\t<input id="restaurant_openTableTime1" value="" type="hidden" />\t<input id="restaurant_openTableTime2" value="" type="hidden" />\t<input id="restaurant_openTableTime3" value="" type="hidden" />\t<table class="clsOpenTableButtonRow" id="restaurant_findTablesBtn">\t\t<tr>\t\t\t<td width="100%">\t\t\t\t<button onclick="OpenTable.fetchTimePeriod()" class="clsBigButtonStyle fs_veryLarge fc_white clsLargeRadius clsButtonBgRed"\t\t\t\t\t\tonTouchStart="changeCSS(this,\'clsBigButtonStyle fs_veryLarge fc_white clsLargeRadius clsButtonBgRedHover\')"  \t\t\t\t\t\tontouchend="changeCSS(this,\'clsBigButtonStyle fs_veryLarge fc_white clsLargeRadius clsButtonBgRed\')">'+
I18NHelper["openTable.findATableButton"]+'\t\t\t\t</button>\t\t\t</td>\t\t</tr>\t</table>\t<table class="clsOpenTableButtonRow">\t\t<tr><td width="100%" align="right"><img alt="openTable.com" src="'+GLOBAL_sharedImageUrl+'opentable_logo.png"></td></tr>\t</table></div>';b.innerHTML=c}};var OpenTable=new OpenTableJS;OpenTable.writeHTML();var GLOBAL_isRestaurantDetailLoaded=false;
